<!DOCTYPE html>
<html lang="zh-TW" class="h-100">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>NavBar + Map + Hot Places (Dynamic Position)</title>

    <!-- Vue 3 (æœ€æ–°) -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

    <!-- Element Plus & Icons (æœ€æ–°) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus/dist/index.css"
    />
    <script src="https://unpkg.com/element-plus"></script>
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>

    <!-- Bootstrap 5 & Icons (æœ€æ–°) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Leaflet (OpenStreetMap) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <style>
      /* å´é‚Šæ¬„å±•é–‹ï¼æ”¶åˆ (Bootstrap ç„¡æ­¤ç´°é …ï¼Œéœ€è¦è‡ªè¡Œå®šç¾©) */
      .aside-collapsed {
        width: 64px;
        transition: width 0.3s ease;
      }
      .aside-expanded {
        width: 160px;
        transition: width 0.3s ease;
      }

      /* è®“ body èˆ‡ä¸»è¦å®¹å™¨æ’æ»¿ç•«é¢ï¼Œä¸¦éš±è—ç€è¦½å™¨æ²è»¸ */
      html,
      body {
        margin: 0;
        padding: 0;
      }
      body {
        overflow: hidden;
      }
      .h-100 {
        height: 100%;
      }

      /* ç§»é™¤è¼¸å…¥æ¡†ã€æŒ‰éˆ•èšç„¦æ™‚çš„å¤–æ¡†ç·š */
      .input-group-text:focus,
      .form-control:focus {
        box-shadow: none !important;
        outline: none !important;
        border: 0 !important;
      }
    </style>
  </head>
  <body class="m-0 p-0 h-100">
    <div
      id="index"
      class="bg-light h-100"
      @click="closePanelOutside"      
    >
    
  

      <div class="d-flex flex-row min-vh-100 h-100">
        
         <!-- Leaflet åœ°åœ–é‹ªæ»¿åº•å±¤ -->
         <div id="map" class="w-100 h-100 z-0"></div>

       

        <!-- ğŸ”¸ å³å´ä¸»è¦å…§å®¹ (el-main) -->
        <el-main
          class="position-relative flex-fill"
          style="min-height: 100vh; padding: 0"
        >
          

         

          

          <!-- ğŸ”¸ ç•¶æœ‰è¼¸å…¥æ™‚ï¼Œé¡¯ç¤ºã€Œç†±é–€æ™¯é»åˆ—è¡¨ã€åœ¨é ‚éƒ¨åˆ—æ­£ä¸‹æ–¹ -->
          <div
            v-if="searchQuery"
            class="card shadow-sm rounded p-3 bg-white"
            :style="placesListStyle"
          >
            <!-- æ¨™é¡Œæ¬„ -->
            <div
              class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-3"
            >
              <div class="dropdown">
                <button
                  class="btn btn-light dropdown-toggle"
                  type="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  @click="toggleDropdown"
                >
                  <i
                    :class="{'bi bi-arrow-down-up': !isDropdownOpen, 'bi bi-arrow-up-down': isDropdownOpen}"
                  ></i>
                  ç†±é–€æ™¯é»
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item active" href="#">ç†±é–€æ™¯é»</a></li>
                  <li><a class="dropdown-item" href="#">ç†±é–€è²¼æ–‡</a></li>
                </ul>
              </div>
              <i
                class="bi bi-x-circle-fill text-muted"
                role="button"
                @click="closeList"
              ></i>
            </div>
            <!-- æ™¯é»å¡ç‰‡åˆ—è¡¨ -->
            <div class="list-group">
              <div
                v-for="(place, index) in places"
                :key="index"
                class="list-group-item border-0 p-3 shadow-sm rounded-3 position-relative d-flex gap-3"
                style="margin-bottom: 8px; background-color: #fff"
              >
                <!-- åœ–ç‰‡å€å¡Š (å«æ„›å¿ƒæŒ‰éˆ•) -->
                <div class="position-relative" style="min-width: 120px">
                  <img
                    :src="place.image"
                    :alt="place.name"
                    class="rounded"
                    style="width: 120px; height: 120px; object-fit: cover"
                  />
                  <!-- æ”¶è—æ„›å¿ƒæŒ‰éˆ• (ç–Šåœ¨åœ–ç‰‡å·¦ä¸‹è§’) -->
                  <button
                    class="btn btn-light btn-sm border rounded-circle position-absolute"
                    style="bottom: 8px; left: 8px; background-color: white"
                    title="æ”¶è—"
                    @click="toggleFavorite(index)"
                    :class="{'btn-danger': place.isFavorite}"
                  >
                    <i
                      :class="{'bi bi-heart': !place.isFavorite, 'bi bi-heart-fill': place.isFavorite}"
                      :style="{ color: place.isFavorite ? 'red' : 'black' }"
                    ></i>
                  </button>
                </div>

                <!-- æ–‡å­—å€å¡Š -->
                <div class="d-flex flex-column flex-grow-1">
                  <strong class="fs-6 mb-1">{{ place.name }}</strong>
                  <div class="text-warning mb-1">
                    â­ {{ place.rating }} ({{ place.reviews }})
                  </div>
                  <small class="text-muted mb-2"
                    >åŠ å…¥è¡Œç¨‹ {{ place.trips }} æ¬¡</small
                  >

                  <!-- æŒ‰éˆ•å€: ç½®åº•å°é½Š -->
                  <div class="d-flex align-items-center gap-2 mt-auto">
                    <!-- ã€Œåˆ°å˜‰ç¾©...ã€æŒ‰éˆ• -->
                    <button
                      class="btn btn-warning btn-sm border-0 rounded-pill d-flex align-items-center gap-1"
                      title="åŠ å…¥è¡Œç¨‹"
                    >
                      åˆ°å˜‰ç¾©... <i class="bi bi-plus"></i>
                    </button>
                    <!-- ã€Œå®šä½ã€æŒ‰éˆ• -->
                    <button
                      class="btn btn-light btn-sm border rounded-circle"
                      title="å®šä½"
                    >
                      <i class="bi bi-geo-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- /ç†±é–€æ™¯é»åˆ—è¡¨ -->
        </el-main>
      </div>
    </div>

    <script>
      const { createApp, ref, computed } = Vue;
      const { Location, Compass, Flag, ShoppingCart, Star, Lightbulb, User } =
        ElementPlusIconsVue;
      
      const app = createApp({    
        data() {
          return {
            /* å´æ¬„å±•é–‹/æ”¶åˆç‹€æ…‹ */
            isCollapsed: true,
            activeIndex: "2",
            isDropdownOpen: false,
            /* æœå°‹æ¬„ä½ */
            searchQuery: "",
            /* ç†±é–€æ™¯é»è³‡æ–™ */
            places: [
              {
                name: "åŒ—æŠ•æº«æ³‰åšç‰©é¤¨",
                rating: "4.5",
                reviews: "9.6K",
                trips: "2365",
                image: "https://picsum.photos/100/100?random=1",
                isFavorite: false,
              },
              {
                name: "è‡ºåŒ—å¸‚ç«‹åœ–æ›¸é¤¨ åŒ—æŠ•åˆ†é¤¨",
                rating: "4.5",
                reviews: "2.9K",
                trips: "1214",
                image: "https://picsum.photos/100/100?random=2",
                isFavorite: false,
              },
              {
                name: "æ–°åŒ—æŠ•è»Šç«™",
                rating: "4.4",
                reviews: "4.9K",
                trips: "908",
                image: "https://picsum.photos/100/100?random=3",
                isFavorite: false,
              },
            ],

            hovered: false,
            showPanel: false,
            selectedOption: "recent_lastEdit",
            /* è¡Œç¨‹è³‡æ–™ */
            trips: [
              {
                img: "https://picsum.photos/200/150?random=1",
                title: "åˆ°å˜‰ç¾©å°±æ˜¯è¦åƒï¼",
                date: "2024/07/01 - 2024/07/03",
              },
              {
                img: "https://picsum.photos/200/150?random=2",
                title: "æµªæ¼«æ±äº¬éŠ ğŸ¦Š",
                date: "2025/01/14 - 2025/01/18",
              },
            ],
          };
        },
        methods: {
          /** å´æ¬„æ»‘å…¥æ»‘å‡º */
          expandMenu() {
            clearTimeout(this.timeoutId);
            this.timeoutId = setTimeout(() => {
              this.isCollapsed = false;
            }, 50);
          },
          collapseMenu() {
            clearTimeout(this.timeoutId);
            this.timeoutId = setTimeout(() => {
              this.isCollapsed = true;
            }, 300);
          },
          /** ç†±é–€æ™¯é»åˆ—è¡¨ç›¸é—œ */
          toggleDropdown() {
            this.isDropdownOpen = !this.isDropdownOpen;
          },
          closeList() {
            // æŒ‰ã€ŒXã€å¾Œå¯æ¸…ç©ºæœå°‹
            this.searchQuery = "";
          },
          toggleFavorite(index) {
            this.places[index].isFavorite = !this.places[index].isFavorite;
          },
          togglePanel(bool) {
            this.showPanel = bool;
          },
          shareTrip(index) {
            alert(`åˆ†äº«è¡Œç¨‹: ${index}`);
          },
          copyTrip(index) {
            alert(`è¤‡è£½è¡Œç¨‹: ${index}`);
          },
          inviteTrip(index) {
            alert(`é‚€è«‹å…±ç·¨: ${index}`);
          },
          deleteTrip(index) {
            alert(`åˆªé™¤è¡Œç¨‹: ${index}`);
          },
          createNewTrip() {
            alert("å»ºç«‹æ–°è¡Œç¨‹");
          },
          closePanelOutside(event) {
            if (!event.target.closest(".position-fixed.top-0.end-0.bottom-0")) {
              this.showPanel = false;
            }
          },
        },
        computed: {
          /**
           * ğŸ”¸ è®“é ‚éƒ¨åˆ—éš¨å´æ¬„å¯¬åº¦ã€Œå¾€å³æ¨ã€
           *    isCollapsed = true => å´æ¬„å¯¬ 64px
           *    isCollapsed = false => å´æ¬„å¯¬ 160px
           */
          //   topBarStyle() {
          //     const sideWidth = this.isCollapsed ? 64 : 160;
          //     return {
          //       left: sideWidth + "px",
          //       transition: "0.3s",
          //     };
          //   },
          /**
           *    ç†±é–€æ™¯é»åˆ—è¡¨ ä½ç½® (å›ºå®šåœ¨æœå°‹åˆ—ä¸‹æ–¹)
           *    è‹¥ä½ æƒ³æ›´è²¼è¿‘æœå°‹æ¡†ï¼Œå¯å¾®èª¿ topã€‚
           *    åŒæ¨£æ ¹æ“šå´æ¬„å¯¬åº¦å‹•æ…‹ä½ç§» leftï¼Œé¿å…è¢«æ“‹ä½ã€‚
           */
          placesListStyle() {
            const sideWidth = this.isCollapsed ? 64 : 160;
            return {
              position: "fixed",
              top: "80px", // å¯å¾®èª¿
              left: sideWidth + "px",
              width: "350px",
              zIndex: "2000",
              transition: "0.3s",
            };
          },
        },
        mounted() {
          // === Leaflet åœ°åœ–åˆå§‹åŒ– ===
          const map = L.map("map", { zoomControl: false }).setView(
            [25.033, 121.5654],
            13
          );

          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution:
              'Â© <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
          }).addTo(map);

          // è‡ªè¨‚ç¸®æ”¾æŒ‰éˆ•äº‹ä»¶
          document.getElementById("btnZoomIn").onclick = () => map.zoomIn();
          document.getElementById("btnZoomOut").onclick = () => map.zoomOut();
          document.getElementById("btnCrosshair").onclick = () => {
            map.setView([25.033, 121.5654], 13);
          };
        },
        // components:{                   
        //     Location,
        //     Compass,
        //     Flag,
        //     ShoppingCart,
        //     Star,
        //     Lightbulb,
        //     User,          
        // },
      })
        app.use(ElementPlus)
        for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
  app.component(key, component);
}
        app.mount("#index");
    </script>
  </body>
</html>
