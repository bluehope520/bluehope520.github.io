<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>NavBar + Map + Trip Panel</title>

  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <!-- Element Plus -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
  <script src="https://unpkg.com/element-plus"></script>

  <!-- Bootstrap 5 & Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Leaflet (OpenStreetMap) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    /* é ‚å³è§’æŒ‰éˆ• Hover å±•é–‹ */
    .hover-expand-btn {
      width: 40px;
      overflow: hidden;
      transition: width 0.3s ease;
    }
    .hover-expand-btn.expanded {
      width: 80px;
    }

    /* å³å´è¡Œç¨‹é¢æ¿ */
    .right-panel {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      width: 360px;
      background-color: #fff;
      box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
      z-index: 1050;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s ease-in-out;
    }

    /* ç¢ºä¿ Element Plus å¡ç‰‡çš„ä¸‹æ‹‰é¸å–®ä¸è¢«è£åˆ‡ */
    .el-card {
      border-radius: 10px;
    }
    .el-card .el-card__body {
      overflow: visible !important;
    }

    /* æé«˜ z-indexï¼Œç¢ºä¿ Dropdown ä¸æœƒè¢«å…¶ä»–å…ƒç´ é®æ“‹ */
    .el-dropdown-menu {
      z-index: 2000 !important;
    }

    /* åœ°åœ–ç‰©ä»¶ç§»å‹• */
    .map-container {
      transition: transform 0.3s ease-in-out;
    }
  </style>
</head>

<body>
  <div id="app">
    <el-container class="d-flex flex-row h-100">
      <!-- ä¸»è¦å…§å®¹ï¼ˆåŒ…å«åœ°åœ–ï¼‰ -->
      <el-main class="position-relative flex-fill p-0">
        <!-- ğŸ”¹ åœ°åœ– (Leaflet) -->
        <div id="map" class="map-container w-100 h-100" :style="mapShiftStyle"></div>

        <!-- ğŸ”¹ å³ä¸Šè§’çš„è¡Œç¨‹æŒ‰éˆ• -->
        <el-button
          v-if="!showPanel"
          type="warning"
          class="position-fixed top-0 end-0 border-0 text-white shadow rounded-start-pill rounded-end-0 d-flex align-items-center gap-1 px-2 py-2 hover-expand-btn"
          style="z-index: 1100; margin-top: 20px"
          @mouseenter="hovered = true"
          @mouseleave="hovered = false"
          :class="{ expanded: hovered }"
          @click="togglePanel(true)"
        >
          <i class="bi bi-briefcase fs-5"></i>
          <span v-if="hovered">è¡Œç¨‹</span>
        </el-button>

        <!-- ğŸ”¹ å³å´è¡Œç¨‹é¢æ¿ -->
        <div v-if="showPanel" class="right-panel">
          <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
            <h2 class="fs-5 m-0">è¡Œç¨‹</h2>
            <i class="bi bi-x fs-3" style="cursor: pointer" @click="togglePanel(false)"></i>
          </div>

          <!-- ä¸‹æ‹‰é¸å–® -->
          <el-select v-model="selectedOption" placeholder="ä¸Šæ¬¡ç·¨è¼¯æ™‚é–“" class="p-3" style="width: 100%; max-width: 300px;">
            <el-option label="ä¸Šæ¬¡ç·¨è¼¯æ™‚é–“" value="recent_lastEdit"></el-option>
            <el-option label="å»ºç«‹æ™‚é–“ (å¾è¿‘åˆ°é )" value="recent_first"></el-option>
            <el-option label="å»ºç«‹æ™‚é–“ (å¾é åˆ°è¿‘)" value="recent_last"></el-option>
          </el-select>

          <!-- è¡Œç¨‹åˆ—è¡¨ -->
          <div class="flex-fill overflow-auto p-3">
            <div class="row row-cols-1 g-3">
              <div class="col" v-for="(trip, index) in trips" :key="index">
                <el-card class="shadow" shadow="hover" :body-style="{ overflow: 'visible' }">
                  <div class="d-flex">
                    <el-image :src="trip.img" style="width: 100px; height: 80px" fit="cover"></el-image>
                    <div class="ms-3">
                      <h3 class="fs-6 mb-1">{{ trip.title }}</h3>
                      <p class="text-muted small mb-0">{{ trip.date }}</p>
                      <div class="d-flex gap-2 justify-content-end mt-1">
                        <el-button type="text" @click="shareTrip(index)">
                          <i class="fa-regular fa-share-from-square"></i>
                        </el-button>
                        <el-dropdown teleported>
                          <el-button type="text">
                            <i class="fa-solid fa-list"></i>
                          </el-button>
                          <template #dropdown>
                            <el-dropdown-menu>
                              <el-dropdown-item @click="copyTrip(index)">ğŸ“‹ è¤‡è£½è¡Œç¨‹</el-dropdown-item>
                              <el-dropdown-item @click="inviteTrip(index)">ğŸ‘¥ é‚€è«‹å…±ç·¨</el-dropdown-item>
                              <el-dropdown-item class="text-danger" @click="deleteTrip(index)">ğŸ—‘ åˆªé™¤è¡Œç¨‹</el-dropdown-item>
                            </el-dropdown-menu>
                          </template>
                        </el-dropdown>
                      </div>
                    </div>
                  </div>
                </el-card>
              </div>
            </div>
          </div>

          <!-- å»ºç«‹æ–°è¡Œç¨‹æŒ‰éˆ• -->
          <div class="p-3">
            <el-button type="primary" size="large" class="w-100" @click="createNewTrip">
              å»ºç«‹æ–°è¡Œç¨‹
            </el-button>
          </div>
        </div>
      </el-main>
    </el-container>
  </div>

  <!-- Vue 3 & Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/element-plus/dist/index.full.min.js"></script>

  <script>
    const { createApp, ref, computed } = Vue;

    createApp({
      data() {
        return {
          hovered: false,
          showPanel: false,
          selectedOption: "recent_lastEdit",
          trips: [
            { img: "https://picsum.photos/200/150?random=1", title: "åˆ°å˜‰ç¾©å°±æ˜¯è¦åƒï¼", date: "2024/07/01 - 2024/07/03" },
            { img: "https://picsum.photos/200/150?random=2", title: "æµªæ¼«æ±äº¬éŠ ğŸ¦Š", date: "2025/01/14 - 2025/01/18" }
          ]
        };
      },
      computed: {
        mapShiftStyle() {
          return this.showPanel ? { transform: "translateX(-180px)" } : {};
        }
      },
      methods: {
        togglePanel(bool) { this.showPanel = bool; },
        shareTrip(index) { alert(`åˆ†äº«è¡Œç¨‹: ${index}`); }
      }
    }).use(ElementPlus).mount("#app");
  </script>
</body>
</html>
